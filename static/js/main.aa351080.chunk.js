(this.webpackJsonpfirst_react_pwa=this.webpackJsonpfirst_react_pwa||[]).push([[0],[,,,,,,function(e,t,n){e.exports=n.p+"static/media/share-100.b1f04eda.png"},function(e,t,n){e.exports=n.p+"static/media/github.85ad9140.png"},,function(e,t,n){e.exports=n(17)},,,,,function(e,t,n){},,function(e,t,n){},function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o),a=n(4),i=n.n(a),c=(n(14),n(2)),l=n.n(c),s=n(5),u=n(1),d=n(6),f=n.n(d),p=n(7),h=n.n(p),b=function(){return r.a.createElement("div",{id:"header"},r.a.createElement("img",{id:"share",onClick:function(){var e;(e=window.navigator).share?e.share({title:"IDB Notes",text:"IDB Notes React PWA",url:"https://idbnotes.imfast.io/"}).then((function(){return alert("Sharing successfull")})).catch((function(e){return console.log("Error sharing",e)})):alert("Sharing is supported only on mobile devices")},alt:"share",src:f.a,width:"30",height:"30"}),r.a.createElement("h1",null,"IDB Notes"),r.a.createElement("a",{id:"gitHub",href:"https://github.com/DaniBencz/React.ts-IDB-Notes-PWA",rel:"noopener noreferrer",target:"_blank"},r.a.createElement("img",{alt:"gitHub repo",src:h.a,width:"33",height:"33"})))},g=n(8),m=function(e){var t=e.db,n=e.note,o=e.updateDisplay;return r.a.createElement("li",{id:"note"},r.a.createElement("h3",null,n.title),r.a.createElement("button",{onClick:function(){return function(){var e=t.transaction("notes_os","readwrite");e.objectStore("notes_os").delete(n.id),e.oncomplete=function(){return o()}}()}},"Delete"),r.a.createElement("p",null,n.descr))},v=function(e){var t=e.db,n=Object(o.useState)([]),a=Object(u.a)(n,2),i=a[0],c=a[1],l=Object(o.useState)(1),s=Object(u.a)(l,2),d=s[0],f=s[1];Object(o.useEffect)((function(){(c([]),t)&&(t.transaction("notes_os").objectStore("notes_os").openCursor().onsuccess=function(e){var t=e.target.result;t&&(c((function(e){return[].concat(Object(g.a)(e),[{id:t.value.id,title:t.value.title,descr:t.value.description}])})),t.continue())})}),[t,d]);var p=function(){f(1===d?2:1)};return r.a.createElement("div",{id:"display"},i.length>0?null:r.a.createElement("h4",null,"Your notes will appear here"),r.a.createElement("ul",null,i.map((function(e){return r.a.createElement(m,{key:e.id,db:t,note:e,updateDisplay:p})}))))},w=function(e){var t=Object(o.useState)(""),n=Object(u.a)(t,2),a=n[0],i=n[1],c=Object(o.useState)(""),l=Object(u.a)(c,2),s=l[0],d=l[1],f=e.addNewNote,p=e.installButton,h=e.installPWA,b=Object(o.useRef)();Object(o.useEffect)((function(){b.current=document.getElementById("title"),console.log("rendering")}),[]);return r.a.createElement("div",{id:"form"},r.a.createElement("h2",null,"New Note"),r.a.createElement("label",null," ",r.a.createElement("input",{id:"title",type:"text",placeholder:"Title",value:a,onChange:function(e){b.current.style.color="black",i(e.target.value)}})),r.a.createElement("label",null,r.a.createElement("input",{id:"description",type:"text",placeholder:"Description",value:s,onChange:function(e){return d(e.target.value)}})),r.a.createElement("button",{id:"create",onClick:function(){a&&"Please provide title!"!==a?(f(a,s),i(""),d("")):(i("Please provide title!"),b.current.style.color="red")}},"Add to list"),!0===p&&r.a.createElement("button",{id:"install",onClick:function(){return h()}},"Install Application"))},E=function(e){var t=Object(o.useState)(!1),n=Object(u.a)(t,2),r=n[0],a=n[1];Object(o.useEffect)((function(){return a(!0)}),[r]),r||e()},j=(n(16),function(){var e=Object(o.useRef)(),t=Object(o.useState)(),n=Object(u.a)(t,2),a=n[0],i=n[1],c=Object(o.useState)(!1),d=Object(u.a)(c,2),f=d[0],p=d[1],h=Object(o.useRef)("pwa_notes_db");E(Object(s.a)(l.a.mark((function t(){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(e,t){if("indexedDB"in window&&void 0!==window.indexedDB){var n=window.indexedDB.open(h.current,1);n.onupgradeneeded=function(e){var t=e.target.result.createObjectStore("notes_os",{keyPath:"id",autoIncrement:!0});t.createIndex("title","title",{unique:!1}),t.createIndex("description","description",{unique:!1})},n.onsuccess=function(t){i(t.target.result),e("db setup successfull")},n.onerror=function(t){return e(n.error)}}else alert("IndexedDB is not supported")}));case 2:n=t.sent,console.log(n),window.addEventListener("beforeinstallprompt",(function(t){e.current=t,p(!0)}));case 5:case"end":return t.stop()}}),t)}))));return a?r.a.createElement("div",{className:"App"},r.a.createElement(b,null),r.a.createElement(v,{db:a}),r.a.createElement(w,{addNewNote:function(e,t){console.log("db in add new",a),a.transaction("notes_os","readwrite").objectStore("notes_os").add({title:e,description:t}).onsuccess=function(){window.indexedDB.open(h.current).onsuccess=function(e){i(e.target.result)}}},installButton:f,installPWA:function(){e.current.prompt(),e.current.userChoice.then((function(e){"accepted"===e.outcome&&alert("Happy Noting!")})),p(!1)}})):r.a.createElement("h1",{style:{color:"white"}},"Waiting for Database Connection...")}),O=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function k(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}i.a.render(r.a.createElement(j,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");O?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var o=n.headers.get("content-type");404===n.status||null!=o&&-1===o.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):k(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):k(t,e)}))}}()}],[[9,1,2]]]);
//# sourceMappingURL=main.aa351080.chunk.js.map